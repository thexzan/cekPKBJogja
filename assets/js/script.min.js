$("#resultpanel").hide();

const merk = $("#merk");
const type = $("#type");
const tahun = $("#tahun");
const pkb = $("#pkb");
const swdkllj = $("#swdkllj");
const total = $("#total");
const jatuhtempo = $("#jatuhtempo");

const getPKB = () => {
  $("#resultpanel").hide();
  $("#howtopanel").show();

  let nopolisi = `AB${$("input").val().substring(4)}${$("input")
    .val()
    .substring(0, 4)}`;

  $.ajax({
    url: "http://36.66.168.197:8484/esamsatnas/r_infopkbad.php",
    type: "GET",
    crossDomain: true,
    headers: {
      "Access-Control-Allow-Origin": "*"
    },
    data: {
      nopolisi
    }
  }).done(data => {
    if (data.length > 100) {
      data = JSON.parse(data.replace(/'/g, `"`));

      merk.text(data.result[0].nmmerekkb);
      type.text(data.result[0].tahunkb);
      tahun.text(data.result[0].nmmerekkb);
      pkb.text(data.result[0].pkb);
      swdkllj.text(data.result[0].swdkllj);
      total.text(data.result[0].pkbswd);
      jatuhtempo.text(data.result[0].tgakhirpkb);
      $("#resultpanel").show();
      $("#howtopanel").hide();
    } else {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "NOPOL Tidak ditemukan"
      });
    }
  });
};

$("form").submit(e => {
  e.preventDefault();
  getPKB();
});

$("#btncek").on("click", getPKB);
