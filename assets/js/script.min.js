$("#resultpanel").hide();

const merk = $("#merk");
const type = $("#type");
const tahun = $("#tahun");
const pkb = $("#pkb");
const swdkllj = $("#swdkllj");
const total = $("#total");
const jatuhtempo = $("#jatuhtempo");

const getPKB = () => {
  $("#resultpanel").hide();
  $("#howtopanel").show();

  let nopolisi = `AB${$("input").val().substring(4)}${$("input")
    .val()
    .substring(0, 4)}`;

  $.ajax({
    url: "https://pkbjogja.netlify.app/.netlify/functions/getPKB",
    type: "POST",
    data: JSON.stringify({
      nopolisi
    })
  }).done(data => {
    if (data.status === "success") {
      merk.text(data.data.nmmerekkb);
      type.text(data.data.tahunkb);
      tahun.text(data.data.nmmerekkb);
      pkb.text(data.data.pkb);
      swdkllj.text(data.data.swdkllj);
      total.text(data.data.pkbswd);
      jatuhtempo.text(data.data.tgakhirpkb);
      $("#resultpanel").show();
      $("#howtopanel").hide();
    } else {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "NOPOL Tidak ditemukan"
      });
    }
  });
};

$("form").submit(e => {
  e.preventDefault();
  getPKB();
});

$("#btncek").on("click", getPKB);
